INFO:__main__:PORT environment variable: not set
INFO:__main__:Starting Unified Server on 0.0.0.0:8000
INFO:__main__:- A2A Agent Card: http://0.0.0.0:8000/agent-card
INFO:__main__:- A2A Tasks: http://0.0.0.0:8000/a2a/task
INFO:__main__:- MCP Endpoint: http://0.0.0.0:8000/mcp
INFO:__main__:- MCP SSE: http://0.0.0.0:8000/mcp/sse
INFO:__main__:- Health Check: http://0.0.0.0:8000/health
INFO:__main__:- API Signals: http://0.0.0.0:8000/api/signals
INFO:     Started server process [36254]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:__main__:API signals called with spec: 'eating out', max_results: 10
INFO:__main__:Created request: signal_spec='eating out' deliver_to=DeliverySpecification(platforms='all', countries=['US']) filters=SignalFilters(catalog_types=None, data_providers=None, max_cpm=None, min_coverage_percentage=None) max_results=5 principal_id=None
Loaded adapter for platform: index-exchange
Database already contains 10 segments, skipping data insertion
Database initialized with sample data
Found 50 segments from database
Total segments for AI ranking: 50
AI ranking took 3.21 seconds
INFO:__main__:Business logic result type: <class 'schemas.GetSignalsResponse'>
INFO:__main__:Business logic result: message="Found 5 signals for 'eating out' with 23.5%-49.3% coverage, $5.00 CPM, available on 1 platform. Additionally, 3 custom segments can be created to better match your specific targeting needs." context_id='ctx_1755019604_r9xkqi' signals=[SignalResponse(signals_agent_segment_id='200071', name='Arts and Entertainment : DiningOut', description='Segment from Peer39', signal_type='audience', data_provider='Peer39', coverage_percentage=49.268996552595524, deployments=[PlatformDeployment(platform='index-exchange', account=None, is_live=True, scope='platform-wide', decisioning_platform_segment_id='ix_200071', estimated_activation_duration_minutes=60)], pricing=PricingModel(cpm=5.0, revenue_share_percentage=15.0, currency='USD'), has_coverage_data=True, has_pricing_data=True), SignalResponse(signals_agent_segment_id='200065', name='Arts and Entertainment', description='Segment from Peer39', signal_type='audience', data_provider='Peer39', coverage_percentage=27.887972077498542, deployments=[PlatformDeployment(platform='index-exchange', account=None, is_live=True, scope='platform-wide', decisioning_platform_segment_id='ix_200065', estimated_activation_duration_minutes=60)], pricing=PricingModel(cpm=5.0, revenue_share_percentage=15.0, currency='USD'), has_coverage_data=True, has_pricing_data=True), SignalResponse(signals_agent_segment_id='200073', name='Arts and Entertainment : Movies and Videos', description='Segment from Peer39', signal_type='audience', data_provider='Peer39', coverage_percentage=40.413526940465864, deployments=[PlatformDeployment(platform='index-exchange', account=None, is_live=True, scope='platform-wide', decisioning_platform_segment_id='ix_200073', estimated_activation_duration_minutes=60)], pricing=PricingModel(cpm=5.0, revenue_share_percentage=15.0, currency='USD'), has_coverage_data=True, has_pricing_data=True), SignalResponse(signals_agent_segment_id='200074', name='Arts and Entertainment : Music', description='Segment from Peer39', signal_type='audience', data_provider='Peer39', coverage_percentage=23.48629432571598, deployments=[PlatformDeployment(platform='index-exchange', account=None, is_live=True, scope='platform-wide', decisioning_platform_segment_id='ix_200074', estimated_activation_duration_minutes=60)], pricing=PricingModel(cpm=5.0, revenue_share_percentage=15.0, currency='USD'), has_coverage_data=True, has_pricing_data=True), SignalResponse(signals_agent_segment_id='200079', name='Automotive', description='Segment from Peer39', signal_type='audience', data_provider='Peer39', coverage_percentage=45.223661363424284, deployments=[PlatformDeployment(platform='index-exchange', account=None, is_live=True, scope='platform-wide', decisioning_platform_segment_id='ix_200079', estimated_activation_duration_minutes=60)], pricing=PricingModel(cpm=5.0, revenue_share_percentage=15.0, currency='USD'), has_coverage_data=True, has_pricing_data=True)] custom_segment_proposals=[CustomSegmentProposal(proposed_name='Dining: Restaurant Reviews & Recommendations', description='Targets pages featuring restaurant reviews, ratings, and recommendations from professional critics, food bloggers, and user-generated content. Focuses on content explicitly offering advice on where to eat.', target_signals="Keywords like 'best restaurants', 'restaurant reviews', 'food critic', 'Michelin star', 'top [city] restaurants', sentiment analysis indicating positive reviews, presence of rating scales (e.g., stars, numerical scores), mentions of specific cuisines (e.g., 'Italian restaurant', 'Thai food'), geo-targeting signals indicating local restaurants.", estimated_coverage_percentage=3.0, estimated_cpm=7.0, creation_rationale="This segment is more specific than the existing 'DiningOut' segment by focusing on pages explicitly dedicated to restaurant recommendations. It excludes broader dining-related content like recipes or articles about food trends. It provides value by targeting users actively seeking information and making decisions about where to eat, indicating a high purchase intent. Sentiment analysis ensures targeting is aligned with positively reviewed establishments.", custom_segment_id='custom_1_4426'), CustomSegmentProposal(proposed_name='Dining: Restaurant Deals & Specials', description='Targets pages promoting restaurant deals, discounts, coupons, and special offers, including limited-time menus and happy hour promotions.', target_signals="Keywords like 'restaurant deals', 'coupons', 'discount', 'happy hour', 'prix fixe', 'special offers', presence of promotional language (e.g., 'Limited Time Offer', 'Buy One Get One'), mentions of specific days of the week (e.g., 'Taco Tuesday'), presence of call-to-action buttons (e.g., 'Get Coupon', 'View Deal').", estimated_coverage_percentage=2.0, estimated_cpm=6.75, creation_rationale="This segment differentiates itself by focusing on the promotional aspects of eating out. It targets users actively searching for ways to save money while dining, indicating price sensitivity and deal-seeking behavior. This is valuable for restaurants looking to fill empty tables and attract customers during off-peak hours or promote specific menu items. It is more granular than 'DiningOut' which does not isolate users specifically looking for deals.", custom_segment_id='custom_2_8129'), CustomSegmentProposal(proposed_name='Dining: Dietary Restriction Focused Restaurants', description='Targets pages featuring restaurants specifically catering to dietary restrictions such as gluten-free, vegan, vegetarian, or allergy-conscious dining.', target_signals="Keywords like 'vegan restaurants', 'gluten-free dining', 'vegetarian menu', 'allergy-friendly restaurants', 'dairy-free options', 'plant-based cuisine', mentions of specific dietary needs (e.g., 'celiac disease', 'lactose intolerance'), presence of menus with clearly labeled dietary options, content focusing on sourcing sustainable or organic ingredients.", estimated_coverage_percentage=1.5, estimated_cpm=8.0, creation_rationale="This segment caters to a growing audience with specific dietary needs and preferences. It goes beyond simply 'DiningOut' by pinpointing content directly related to these restrictions. This allows advertisers to reach a highly engaged and specific audience seeking restaurants that meet their unique requirements, leading to increased relevance and higher conversion rates. This segment addresses the growing consumer focus on health and ethical eating.", custom_segment_id='custom_3_5137')] clarification_needed=None ranking_method='ai_ranking'
INFO:__main__:Found 5 signals in result.signals
INFO:     127.0.0.1:54361 - "GET /api/signals?spec=eating%20out HTTP/1.1" 200 OK
INFO:__main__:API signals called with spec: 'eating out', max_results: 10
INFO:__main__:Created request: signal_spec='eating out' deliver_to=DeliverySpecification(platforms='all', countries=['US']) filters=SignalFilters(catalog_types=None, data_providers=None, max_cpm=None, min_coverage_percentage=None) max_results=5 principal_id=None
Found 50 segments from database
Total segments for AI ranking: 50
AI ranking took 2.20 seconds
INFO:__main__:Business logic result type: <class 'schemas.GetSignalsResponse'>
INFO:__main__:Business logic result: message="Found 4 signals for 'eating out' with 23.5%-49.3% coverage, $5.00 CPM, available on 1 platform. Additionally, 3 custom segments can be created to better match your specific targeting needs." context_id='ctx_1755019619_hwt4dq' signals=[SignalResponse(signals_agent_segment_id='200071', name='Arts and Entertainment : DiningOut', description='Segment from Peer39', signal_type='audience', data_provider='Peer39', coverage_percentage=49.268996552595524, deployments=[PlatformDeployment(platform='index-exchange', account=None, is_live=True, scope='platform-wide', decisioning_platform_segment_id='ix_200071', estimated_activation_duration_minutes=60)], pricing=PricingModel(cpm=5.0, revenue_share_percentage=15.0, currency='USD'), has_coverage_data=True, has_pricing_data=True), SignalResponse(signals_agent_segment_id='200065', name='Arts and Entertainment', description='Segment from Peer39', signal_type='audience', data_provider='Peer39', coverage_percentage=27.887972077498542, deployments=[PlatformDeployment(platform='index-exchange', account=None, is_live=True, scope='platform-wide', decisioning_platform_segment_id='ix_200065', estimated_activation_duration_minutes=60)], pricing=PricingModel(cpm=5.0, revenue_share_percentage=15.0, currency='USD'), has_coverage_data=True, has_pricing_data=True), SignalResponse(signals_agent_segment_id='200073', name='Arts and Entertainment : Movies and Videos', description='Segment from Peer39', signal_type='audience', data_provider='Peer39', coverage_percentage=40.413526940465864, deployments=[PlatformDeployment(platform='index-exchange', account=None, is_live=True, scope='platform-wide', decisioning_platform_segment_id='ix_200073', estimated_activation_duration_minutes=60)], pricing=PricingModel(cpm=5.0, revenue_share_percentage=15.0, currency='USD'), has_coverage_data=True, has_pricing_data=True), SignalResponse(signals_agent_segment_id='200074', name='Arts and Entertainment : Music', description='Segment from Peer39', signal_type='audience', data_provider='Peer39', coverage_percentage=23.48629432571598, deployments=[PlatformDeployment(platform='index-exchange', account=None, is_live=True, scope='platform-wide', decisioning_platform_segment_id='ix_200074', estimated_activation_duration_minutes=60)], pricing=PricingModel(cpm=5.0, revenue_share_percentage=15.0, currency='USD'), has_coverage_data=True, has_pricing_data=True)] custom_segment_proposals=[CustomSegmentProposal(proposed_name='DiningOut: Cuisine Specific', description='Targets content related to specific cuisines, such as Italian, Mexican, Asian (Chinese, Japanese, Thai, etc.), American, Mediterranean, and Indian. This segment allows for granular targeting based on culinary preferences.', target_signals="Keywords related to specific cuisines (e.g., 'pasta', 'tacos', 'sushi', 'burger', 'falafel', 'curry'), mentions of specific dishes (e.g., 'spaghetti carbonara', 'chicken enchiladas', 'California roll', 'cheeseburger', 'hummus', 'chicken tikka masala'), references to popular restaurants of specific cuisine types (e.g., 'Olive Garden', 'Chipotle', 'Nobu', 'McDonald's', 'Zoe's Kitchen', 'Tandoori Nights'). Sentiment analysis indicating positive or neutral opinions about these cuisines or restaurants.", estimated_coverage_percentage=5.0, estimated_cpm=4.75, creation_rationale="This segment allows advertisers to target users interested in specific types of food, offering greater precision than the broader 'DiningOut' segment.  For example, an Italian restaurant chain could target users reading content about pasta recipes or Italian travel destinations. The use of keyword lists and sentiment analysis ensures relevance and minimizes wasted impressions.", custom_segment_id='custom_4_231'), CustomSegmentProposal(proposed_name='DiningOut: Restaurant Deals and Discounts', description='Targets content focused on restaurant deals, discounts, coupons, and promotions. This segment captures users actively seeking cost-effective dining options.', target_signals="Keywords like 'restaurant deals', 'discount dining', 'coupons', 'promotions', 'happy hour', 'early bird specials', 'meal deals', 'Groupon dining', 'restaurant rewards programs'.  Website URLs of deal aggregators (e.g., Groupon, LivingSocial), and restaurant websites with dedicated promotions pages. Contextual signals indicating time sensitivity (e.g., 'limited time offer', 'expires soon').", estimated_coverage_percentage=2.0, estimated_cpm=5.25, creation_rationale='This segment is distinct because it focuses on the *intent* of the user, rather than just the general topic of eating out. It captures users actively looking for deals, making them highly receptive to restaurant advertising. This segment would be valuable for restaurants looking to drive traffic during off-peak hours or promote specific promotions. By targeting users interested in deals, the ROI on ad spend is likely to be significantly higher.', custom_segment_id='custom_5_3724'), CustomSegmentProposal(proposed_name='DiningOut: Restaurant Reviews and Recommendations', description="Targets content related to restaurant reviews (both professional and user-generated), restaurant recommendation articles, and 'best of' lists for restaurants in specific locations or categories.", target_signals="Keywords like 'restaurant reviews', 'best restaurants', 'restaurant recommendations', 'food blogs', 'Yelp', 'TripAdvisor restaurants', 'Michelin Guide', 'dining guide'. Sentiment analysis of review text, focusing on positive mentions and star ratings. Location data to identify restaurants in specific geographic areas. Semantic analysis to understand the context of the reviews (e.g., type of cuisine, ambiance, price range).", estimated_coverage_percentage=3.0, estimated_cpm=6.0, creation_rationale="This segment identifies users who are actively researching dining options and are therefore highly receptive to restaurant advertising. This is more targeted than 'DiningOut' as it captures users at the decision-making stage. This segment is valuable because it allows restaurants to target users who are actively seeking recommendations and are more likely to try new places. Positive sentiment and high ratings are key signals to ensure relevance and avoid showing ads for poorly-reviewed establishments.", custom_segment_id='custom_6_5145')] clarification_needed=None ranking_method='ai_ranking'
INFO:__main__:Found 4 signals in result.signals
INFO:     127.0.0.1:54368 - "GET /api/signals?spec=eating%20out HTTP/1.1" 200 OK
